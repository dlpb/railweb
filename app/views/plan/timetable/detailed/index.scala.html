@(
user: models.auth.User,
token: String,
timetable: models.timetable.dto.train.detailed.DisplayDetailedTrainTimetable,
basicSchedule: models.timetable.model.train.BasicSchedule,
locations: List[models.location.Location],
routeList: List[models.route.Route],
routeLink: String,
messages: List[String]
)(implicit request: Request[AnyContent])
@templates.main(timetable.origin+" to "+timetable.destination+" - Detailed Search", "Plan",  Some(user)){

<script>
    const token = "@token";
</script>


<style>
     tr.pass {
       font-style: italic;
       color: gray;
    }
    tr.pass a {
        color:gray;
    }

    .table-light a {
        color: gray;
    }
</style>


<div class="container card-body">
    <div class="row">
        <div class="col-sm">
            <div id='title' class="alert alert-secondary">
                <h3>
                    <strong><span id="operator-name"></span></strong> Service from <strong>@timetable.origin</strong> to <strong>@timetable.destination</strong>
                </h3> running on <strong>@timetable.runningOn</strong>
                <script>
                    const tocInfo = findTocData('@timetable.operator');
                    const element = document.getElementById('title');

                    element.style.backgroundColor = tocInfo["colour"];
                    element.style.color = tocInfo["textColour"];

                    const title = document.getElementById('operator-name');
                    title.textContent = tocInfo["name"];
                </script>
            </div>
        </div>
    </div>
    @bs(basicSchedule)
    <div class="row">
        <div class="col col-sm">
        @templates.map.map(List.empty, List.empty)
        <script type="text/javascript">

            populateDetailedTrainCallingPoints(map, token, "@timetable.uid", @timetable.day, @timetable.month, @timetable.year)
            populateTrainConnections(map, token, "@timetable.uid", @timetable.day, @timetable.month, @timetable.year)
        </script>

        </div>
    </div>
</div>
<div class="container card-body">
    <div class="toolbar">
        <a class="btn btn-primary" href="@routeLink" role="button">Visit Route</a>
        <a class="btn btn-primary" href="/plan/timetables/train/@timetable.uid/simple/@timetable.runningOn.toString.replaceAll("-", "/")" role="button">Simple Timetable</a>
    </div>
</div>
<div class="container card-body">
    <div class="">
        <div class="col-sm">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <td><div class="d-block d-lg-none">Arr.</div><div class="d-none d-lg-block">Arrival</div></td>
                        <td>Location</td>
                        <td><div class="d-block d-lg-none">Pl.</div><div class="d-none d-lg-block">Platform</div></td>
                        <td><div class="d-block d-lg-none">Dep.</div><div class="d-none d-lg-block">Departure</div></td>
                        <td><div class="d-block d-lg-none"></div><div class="d-none d-lg-block">Distance</div></td>
                    </tr>
                    </thead>
                   @for(l <- timetable.locations){
                        @location(l)
                    }
                </table>
            </div>
        </div>
    </div>
</div>
}

@bs(bs: models.timetable.model.train.BasicSchedule) = {
<div class="row">
    <div class="col-lg">
        <h4>Date Information</h4>
        <dl class="row">
            <dt class="col-sm-3">Runs</dt>
            <dd class="col-sm-9">@if(bs.validMonday) { M }
                @if(bs.validTuesday) { T }
                @if(bs.validWednesday) { W }
                @if(bs.validThursday) { Th }
                @if(bs.validFriday) { F }
                @if(bs.validSaturday) { S }
                @if(bs.validSunday) { Su }</dd>
            <dt class="col-sm-3">From</dt>
            <dd class="col-sm-9">@timetable.from</dd>
            <dt class="col-sm-3">To</dt>
            <dd class="col-sm-9">@timetable.to</dd>
            <dt class="col-sm-3"></dt>
            <dd class="col-sm-9">@bs.bankHolidayRunning</dd>
        </dl>

    </div>
    <div class="col-lg">
        <h4>Train Identity</h4>
        <dl class="row">
            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9">@bs.trainStatus</dd>
            <dt class="col-sm-3">Type</dt>
            <dd class="col-sm-9">@bs.trainCategory</dd>
            <dt class="col-sm-3">Identity</dt>
            <dd class="col-sm-9">@bs.trainIdentity</dd>
            <dt class="col-sm-3">UID</dt>
            <dd class="col-sm-9">@bs.trainUid</dd>
            <dt class="col-sm-3">Train Status</dt>
            <dd class="col-sm-9">@bs.trainStatus</dd>
            <dt class="col-sm-3">STP</dt>
            <dd class="col-sm-9">@bs.stpIndicator</dd>
        </dl>
    </div>
    <div class="col-lg">
        <h4>Traction Information</h4>
        <dl class="row">
            <dt class="col-sm-3">Power Type</dt>
            <dd class="col-sm-9">@bs.powerType</dd>
            <dt class="col-sm-3">Timing</dt>
            <dd class="col-sm-9">@bs.timing</dd>
            <dt class="col-sm-3">Max Speed</dt>
            <dd class="col-sm-9">@bs.speed mph</dd>
            <dt class="col-sm-3">More Info</dt>
            <dd class="col-sm-9">@bs.operatingCharacteristics.mkString(", ")</dd>
        </dl>
    </div>
    <div class="col-lg">
        <h4>Passenger Information</h4>
        <dl class="row">
            <dt class="col-sm-3">Seating</dt>
            <dd class="col-sm-9">@bs.seating</dd>
            <dt class="col-sm-3"></dt>
            <dd class="col-sm-9">@bs.reservations</dd>
            <dt class="col-sm-3">Sleeper</dt>
            <dd class="col-sm-9">@bs.sleepers</dd>
            @if(bs.catering.nonEmpty) {
                <dt class="col-sm-3">Catering</dt>
                <dd class="col-sm-9">@bs.catering</dd>
            }
            @if(!bs.branding.isBlank) {
                <dt class="col-sm-3">Branding</dt>
                <dd class="col-sm-9">@bs.branding</dd>
            }
        </dl>
    </div>
</div>
}

@location(l: models.timetable.dto.train.detailed.DisplayDetailedTrainTimetableCallingPoint) = {
    @if(l.isPass) { <tr class="pass  table-light">
    } else { <tr>
    }

        <td>
            <a href="@l.url">
                @arr(l)
            </a>
        </td>
        <td>
            <a href="@l.url">
                @l.label <br/>
                @l.id @l.crs <br/>
            </a>
            <div>
                @if(!l.pathAllowance.isBlank){l.pathAllowance <br/>}
                @if(!l.performanceAllowance.isBlank){l.performanceAllowance <br/>}
                @if(!l.engineeringAllowance.isBlank){l.engineeringAllowance} <br/>
            </div>
            <div>
                @if(null != l.path && !l.path.isBlank){Path: @l.path, }
                @if(null != l.line && !l.line.isBlank){Line: @l.line}
            </div>
        </td>
        <td>
            <a href="@l.url">
                @platform(l)
            </a>
        </td>
        <td>
            <a href="@l.url">
                @dep(l)
            </a>
        </td>
        <td>
            @l.cumulativeDistance
        </td>
    </tr>
}

@platform(l: models.timetable.dto.train.detailed.DisplayDetailedTrainTimetableCallingPoint) = {
    @l.platform
}

@arr(l: models.timetable.dto.train.detailed.DisplayDetailedTrainTimetableCallingPoint) = {
    @l.arrival
}

@dep(l: models.timetable.dto.train.detailed.DisplayDetailedTrainTimetableCallingPoint) = {
    @l.departure
}
