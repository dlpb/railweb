@import helper._

@import models.route.display.map.MapRoute
@(
        user: models.auth.User,
        routeVisits: List[models.data.RouteVisit],
        routeVisitEvents: Map[(String, String), List[models.data.Event]],
        mapRoutes: List[MapRoute]
)(implicit request: Request[AnyContent])

@templates.main("All Visits by Route", "Profile", Some(user)){


<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/profile">Profile</a></li>
        <li class="breadcrumb-item"><a href="/profile/visits">Visits</a></li>
        <li class="breadcrumb-item active" aria-current="page">By Route</li>
    </ol>
</nav>

        <div class="row">
            <div class="col-sm">
                <h1>Routes</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-sm">
                <div id="map" class="map"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm">
                @for(visit <- routeVisits) {
                <ul>
                    <li>
                        <a href="/route/detail/@visit.visited.from/@visit.visited.to" target="_blank">@visit.visited.from.name - @visit.visited.to.name</a> - visited times
                          @for(events <- routeVisitEvents.get((visit.visited.from.id, visit.visited.to.id))) {
                              <ul>
                                @for(event <- events) {

                                    <li><a href="/profile/visits/by/event/@event.id">@event.name (@event.startedAt-@event.endedAt)</a></li>
                                }
                              </ul>
                          }
                    </li>
                </ul>

                }
            </div>
        </div>


<script type="text/javascript">
        createMap();
        @for(route <- mapRoutes) {
            addSingleConnection(
            {
                "from": {
                    "lat":@route.from.lat,
                    "lon":@route.from.lon
                },
                "to": {
                    "lat":@route.to.lat,
                    "lon":@route.to.lon
                },
                "srs":"@route.srsCode",
                "toc":"@route.toc"
            })
        }

</script>

}